**Лабораторная работа по теме: Google Sheets (продвинутый уровень) - 4 урока**

---

**Практическая часть**

1. **Создание связанных таблиц с автоматическим обновлением данных**  
   - Создайте две новые таблицы в Google Sheets:  
     - **«1. Исходные данные»** — для хранения первичной информации.  
     - **«2. Отчётный лист»** — для анализа и визуализации.  
   - В таблицу **«1. Исходные данные»** введите следующие столбцы в строке 1:  
     *Дата, ФИО, Отдел, План (руб.), Факт (руб.), Эффективность (%)*.  
   - Заполните 15 строк данными (можно использовать вымышленные данные за месяц).  
   - В ячейку **F2** введите формулу: `=E2/D2*100` и протяните до **F16** — это процент выполнения плана.

2. **Импорт данных между листами с динамическими ссылками**  
   - Перейдите на лист **«2. Отчётный лист»**.  
   - В ячейку **A1** введите: `=IMPORTRANGE("ваш_URL_таблицы", "1. Исходные данные!A1:F16")`  
     - Замените `"ваш_URL_таблицы"` на реальную ссылку вашей таблицы (её можно скопировать из адресной строки).  
     - При первом использовании появится запрос на разрешение — нажмите «Разрешить доступ».  
   - Убедитесь, что данные с листа «1. Исходные данные» автоматически отобразились.

3. **Фильтрация и анализ с функциями ФИЛЬТР и СУММЕСЛИМН**  
   - На листе **«2. Отчётный лист»** создайте раздел «Аналитика» (начните с ячейки **H1**).  
   - В **H2** введите: *Отдел продаж*.  
   - В **I2** введите формулу:  
     `=СУММЕСЛИМН(E:E; B:B; "Продажи"; A:A; ">=01.04.2025"; A:A; "<=30.04.2025")`  
     — подсчёт суммы "Факт" для отдела "Продажи" за апрель 2025.  
   - Ниже создайте таблицу с топ-5 сотрудников по эффективности:  
     В **H5** напишите: *Топ по эффективности*, в **H6:H10** — номера 1–5.  
     В **I6** введите формулу:  
     `=SORT(FILTER(B2:B16&" ("&F2:F16&"%)", F2:F16<>""), 1, ЛОЖЬ)`  
     — отсортированный список сотрудников по убыванию эффективности.

4. **Создание интерактивного дашборда с выпадающими списками**  
   - В ячейку **H15** введите: *Фильтр по отделу*.  
   - В **I15** вставьте выпадающий список:  
     - Выделите **I15** → **Данные → Проверка данных** →  
       Критерий: *Список элементов*, введите:  
       `Продажи, Маркетинг, IT, Кадры` (через запятую).  
   - В **H17** напишите: *Сумма по отделу*.  
   - В **I17** введите формулу:  
     `=СУММЕСЛИ(B:B; I15; E:E)` — сумма "Факт" для выбранного отдела.  
   - Теперь при изменении значения в **I15** сумма будет обновляться автоматически.

5. **Построение динамической диаграммы**  
   - Выделите диапазон с данными по отделам (например, сводку: отдел и сумма).  
   - Нажмите **Вставка → Диаграмма**.  
   - Выберите тип: **Круговая диаграмма**.  
   - Настройте заголовок: *Выполнение плана по отделам*.  
   - Привяжите диаграмму к выпадающему списку (если используется сводная таблица — обновится автоматически).  
   - Переместите диаграмму в правую часть листа.

6. **Автоматизация с помощью Google Apps Script (создание кнопки)**  
   - Перейдите в меню **Расширения → Редактор приложений**.  
   - Вставьте следующий код:

   ```javascript
   function clearData() {
     var sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("1. Исходные данные");
     sheet.getRange("A2:F16").clearContent();
   }

   function onOpen() {
     SpreadsheetApp.getUi()
       .createMenu("⚡ Автоинструменты")
       .addItem("Очистить данные", "clearData")
       .addToUi();
   }
   ```

   - Сохраните проект как **«Автоматизация отчётов»**.  
   - Закройте редактор и **обновите страницу**.  
   - В меню появится новое меню **⚡ Автоинструменты** с командой *Очистить данные*.  
   - Проверьте, что при нажатии данные в указанном диапазоне удаляются.

7. **Настройка уведомлений и совместного доступа**  
   - Выделите ячейку **I17** (сумма по отделу).  
   - Кликните правой кнопкой → **Установить оповещение о диапазоне**.  
   - Настройте: *Если значение больше 500000 — уведомить по email*.  
   - Нажмите «Готово».  
   - Нажмите кнопку **«Поделиться»** → добавьте любой email (например, polivanov004@gmail.com) с правами **«Комментировать»**.  
   - Убедитесь, что доступ установлен.

---

**Задачи для самостоятельного выполнения**

1. Добавьте в дашборд второй фильтр — по дате — и сделайте динамический график.  
2. Создайте сводную таблицу, показывающую эффективность по месяцам.  
3. Напишите скрипт, который автоматически добавляет текущую дату при заполнении новой строки.

---

**Контрольные вопросы** *(отвечать устно)*

1. Как работает функция `IMPORTRANGE` и зачем она нужна в командной работе?  
2. В чём преимущество использования выпадающих списков и динамических формул перед ручным вводом?

---

**Слепая печать**  
1. Перейдите на сайт [stamina-online](https://stamina-online.com/ru/lessons/ru) и авторизуйтесь или зарегайтесь.
2. Пройдите последние 4 урока из раздела "Цифры и символы"<img width="841" height="62" alt="image" src="https://github.com/user-attachments/assets/797c7ecc-ba47-490f-b2a2-45d53fb78bb0" /><img width="844" height="303" alt="image" src="https://github.com/user-attachments/assets/3f506a5e-dc09-45d5-b07f-98a266d23a2f" />



---

**Примечание:**  
Несмотря на продвинутый уровень, работа оценивается только как **«зачтено»** или **«не зачтено»** из-за учебного формата.
